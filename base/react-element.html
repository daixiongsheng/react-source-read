<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ReactElement | React 源码阅读</title>
    <meta name="generator" content="react源码阅读 1.8.2">
    <link rel="icon" href="/react-source-read/favicon.ico">
    <meta name="description" content="React 源码阅读">
    
    <link rel="preload" href="/react-source-read/assets/css/0.styles.6860f36f.css" as="style"><link rel="preload" href="/react-source-read/assets/js/app.ff704209.js" as="script"><link rel="preload" href="/react-source-read/assets/js/2.9b376a3e.js" as="script"><link rel="preload" href="/react-source-read/assets/js/11.e90170d2.js" as="script"><link rel="prefetch" href="/react-source-read/assets/js/10.61eb32af.js"><link rel="prefetch" href="/react-source-read/assets/js/12.1b8ee042.js"><link rel="prefetch" href="/react-source-read/assets/js/13.33c002e6.js"><link rel="prefetch" href="/react-source-read/assets/js/14.8319a3cc.js"><link rel="prefetch" href="/react-source-read/assets/js/15.db0811fc.js"><link rel="prefetch" href="/react-source-read/assets/js/16.e06f59fd.js"><link rel="prefetch" href="/react-source-read/assets/js/17.3f903aa8.js"><link rel="prefetch" href="/react-source-read/assets/js/3.6ad1ee39.js"><link rel="prefetch" href="/react-source-read/assets/js/4.81effb26.js"><link rel="prefetch" href="/react-source-read/assets/js/5.ca735a4e.js"><link rel="prefetch" href="/react-source-read/assets/js/6.6bd887e7.js"><link rel="prefetch" href="/react-source-read/assets/js/7.1e3183a8.js"><link rel="prefetch" href="/react-source-read/assets/js/8.3f493863.js"><link rel="prefetch" href="/react-source-read/assets/js/9.2e1041b3.js">
    <link rel="stylesheet" href="/react-source-read/assets/css/0.styles.6860f36f.css">
</head>

<body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/react-source-read/" class="home-link router-link-active"><img src="/react-source-read/img/logo.png" alt="React 源码阅读" class="logo"> <span class="site-name can-hide">React 源码阅读</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/daixiongsheng/react-source-read" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/daixiongsheng/react-source-read" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/react-source-read/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/react-source-read/guide/" class="sidebar-link">目录</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>基础</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/react-source-read/base/jsx.html" class="sidebar-link">JSX</a></li><li><a href="/react-source-read/base/api.html" class="sidebar-link">React API</a></li><li><a href="/react-source-read/base/react-element.html" aria-current="page" class="active sidebar-link">ReactElement</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/react-source-read/base/whole-process.html" class="sidebar-link">整体流程</a></li></ul></section></li><li><a href="/react-source-read/dataBase/" class="sidebar-link">React当中的数据结构</a></li><li><a href="/react-source-read/react-dom/" class="sidebar-link">ReactDOM</a></li><li><a href="/react-source-read/react-reconciler/" class="sidebar-link">任务调度</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="react-core"><a href="#react-core" class="header-anchor">#</a> React Core</h3> <p>React “Core” 中包含所有<a href="https://zh-hans.reactjs.org/docs/top-level-api.html#react" target="_blank" rel="noopener noreferrer">全局 <code>React</code> API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，比如：</p> <ul><li><code>React.createElement()</code></li> <li><code>React.Component</code></li> <li><code>React.Children</code></li></ul> <p><strong>React 核心只包含定义组件必要的 API</strong>。它不包含<a href="https://zh-hans.reactjs.org/docs/reconciliation.html" target="_blank" rel="noopener noreferrer">协调<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>算法或者其他平台特定的代码。它同时适用于 React DOM 和 React Native 组件。</p> <p>React 核心代码在源码的 <a href="https://github.com/facebook/react/tree/master/packages/react" target="_blank" rel="noopener noreferrer"><code>packages/react</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 目录中。在 npm 上发布为 <a href="https://www.npmjs.com/package/react" target="_blank" rel="noopener noreferrer"><code>react</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 包。相应的独立浏览器构建版本称为 <code>react.js</code>，它会导出一个称为 <code>React</code> 的全局对象。</p> <h3 id=""><a href="#" class="header-anchor">#</a></h3> <h3 id="渲染器"><a href="#渲染器" class="header-anchor">#</a> 渲染器</h3> <p>React 最初只是服务于 DOM，但是这之后被改编成也能同时支持原生平台的 <a href="https://reactnative.dev/" target="_blank" rel="noopener noreferrer">React Native<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。因此，在 React 内部机制中引入了“渲染器”这个概念。</p> <p><strong>渲染器用于管理一棵 React 树，使其根据底层平台进行不同的调用。</strong></p> <p>渲染器同样位于 <a href="https://github.com/facebook/react/tree/master/packages/" target="_blank" rel="noopener noreferrer"><code>packages/</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 目录下：</p> <ul><li><a href="https://github.com/facebook/react/tree/master/packages/react-dom" target="_blank" rel="noopener noreferrer">React DOM Renderer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 将 React 组件渲染成 DOM。它实现了全局 <a href="https://zh-hans.reactjs.org/docs/react-dom.html" target="_blank" rel="noopener noreferrer"><code>ReactDOM</code>API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，这在 npm 上作为 <a href="https://www.npmjs.com/package/react-dom" target="_blank" rel="noopener noreferrer"><code>react-dom</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 包。这也可以作为单独浏览器版本使用，称为 <code>react-dom.js</code>，导出一个 <code>ReactDOM</code> 的全局对象.</li> <li><a href="https://github.com/facebook/react/tree/master/packages/react-native-renderer" target="_blank" rel="noopener noreferrer">React Native Renderer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 将 React 组件渲染为 Native 视图。此渲染器在 React Native 内部使用。</li> <li><a href="https://github.com/facebook/react/tree/master/packages/react-test-renderer" target="_blank" rel="noopener noreferrer">React Test Renderer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 将 React 组件渲染为 JSON 树。这用于 <a href="https://facebook.github.io/jest" target="_blank" rel="noopener noreferrer">Jest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的<a href="https://facebook.github.io/jest/blog/2016/07/27/jest-14.html" target="_blank" rel="noopener noreferrer">快照测试<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>特性。在 npm 上作为 <a href="https://www.npmjs.com/package/react-test-renderer" target="_blank" rel="noopener noreferrer">react-test-renderer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 包发布。</li></ul> <p>另外一个官方支持的渲染器的是 <a href="https://github.com/facebook/react/tree/master/packages/react-art" target="_blank" rel="noopener noreferrer"><code>react-art</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。它曾经是一个独立的 <a href="https://github.com/reactjs/react-art" target="_blank" rel="noopener noreferrer">GitHub 仓库<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，但是现在我们将此加入了主源代码树。</p> <h3 id="reconcilers"><a href="#reconcilers" class="header-anchor">#</a> reconcilers</h3> <p>即便 React DOM 和 React Native 渲染器的区别很大，但也需要共享一些逻辑。特别是<a href="https://zh-hans.reactjs.org/docs/reconciliation.html" target="_blank" rel="noopener noreferrer">协调<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>算法需要尽可能相似，这样可以让声明式渲染，自定义组件，state，生命周期方法和 refs 等特性，保持跨平台工作一致。</p> <p>为了解决这个问题，不同的渲染器彼此共享一些代码。我们称 React 的这一部分为 “reconciler”。当处理类似于 <code>setState()</code> 这样的更新时，reconciler 会调用树中组件上的 <code>render()</code>，然后决定是否进行挂载，更新或是卸载操作。</p> <p>Reconciler 没有单独的包，因为他们暂时没有公共 API。相反，它们被如 React DOM 和 React Native 的渲染器排除在外。</p> <h3 id="fiber-reconciler"><a href="#fiber-reconciler" class="header-anchor">#</a> Fiber reconciler</h3> <p>“fiber” reconciler 是一个新尝试，致力于解决 stack reconciler 中固有的问题，同时解决一些历史遗留问题。Fiber 从 React 16 开始变成了默认的 reconciler。</p> <p>它的主要目标是：</p> <ul><li>能够把可中断的任务切片处理。</li> <li>能够调整优先级，重置并复用任务。</li> <li>能够在父元素与子元素之间交错处理，以支持 React 中的布局。</li> <li>能够在 <code>render()</code> 中返回多个元素。</li> <li>更好地支持错误边界。</li></ul> <h3 id="-2"><a href="#-2" class="header-anchor">#</a></h3> <h3 id="挂载是递归过程"><a href="#挂载是递归过程" class="header-anchor">#</a> 挂载是递归过程</h3> <p>reconciler 检查 <code>App</code> 是一个类还是一个函数。</p> <p>如果 <code>App</code> 是函数，那么 reconciler 会调用 <code>App(props)</code> 来获取渲染的元素。</p> <p>如果 <code>App</code> 是类，那么 reconciler 会通过 <code>new App(props)</code> 来实例化 <code>App</code>，并调用生命周期方法 <code>componentWillMount()</code>，之后调用 <code>render()</code> 方法来获取渲染的元素。</p> <p>无论哪种方式，reconciler 都会探悉 <code>App</code> 的内容并渲染。</p> <p>这个过程是递归的。<code>App</code> 可能会渲染某个 <code>&lt;Greeting /&gt;</code>，<code>Greeting</code> 可能会渲染某个 <code>&lt;Button /&gt;</code>，以此类推。当它探悉各个组件渲染的元素时，reconciler 会通过用户定义的组件递归地 “向下探索”。</p> <p><strong>注意：</strong></p> <p>reconciler 本身不与 DOM 绑定。挂载的确切结果（在源代码中有时叫做 “挂载映像”）取决于 renderer，可以是一个 DOM 节点（React DOM），一个字符串（React DOM Server），或是一个表示原生视图的数字（React Native）。</p> <h3 id="事件系统"><a href="#事件系统" class="header-anchor">#</a> 事件系统</h3> <p>React 在原生事件基础上进行了封装，以抹平浏览器间差异。其源码在 <a href="https://github.com/facebook/react/tree/master/packages/react-dom/src/events" target="_blank" rel="noopener noreferrer"><code>packages/react-dom/src/events</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 目录下。</p> <h3 id="-3"><a href="#-3" class="header-anchor">#</a></h3></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/react-source-read/base/api.html" class="prev">
        React API
      </a></span> <span class="next"><a href="/react-source-read/base/whole-process.html">
        整体流程
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/react-source-read/assets/js/app.ff704209.js" defer></script><script src="/react-source-read/assets/js/2.9b376a3e.js" defer></script><script src="/react-source-read/assets/js/11.e90170d2.js" defer></script>
</body>

</html>
